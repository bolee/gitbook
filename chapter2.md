# 第三章 日志处理

日志可以记录调试信息、数据状况和用户操作信息，在必要情况下将用户端的日志文件上传到服务器可以更加精准定位到特定场景下的系统崩溃信息，对系统稳定和版本覆盖都有极高的帮助。

## 一、调试日志

1. 调试阶段的日志只出现在测试包，提交到`App Store`时候不允许携带，大量的日志会影响到执行速度，可以使用`DEBUG`宏进行控制，也可以自定义其他参数，在编译里面进行设置，可以设置多个`Configuration`

2. 针对不同模块的日志，需要对外提供日志开关，特别是在多人开发时候，日志过多会影响到其他模块调试速度。

3. 调试日志在功能开发完成之后只需要保留必要的部分，否则也会造成过多累计，影响到其他部分。只有在功能开发或追踪`bug`时候才可能需要大量日志进行分析。

## 二、线上日志

只有极少特殊数据才需要在发布的`release`包里面打印，大部分的线上日志需要保存到文件或上传到服务器日志系统(如果有)。尽量不要在线上版本进行`NSLog`打印日志，还会存在敏感数据风险。

## 三、日志存储

1. 如有专门日志服务器，可以将一些特殊数据或出现错误时候的数据进行上传到服务器共分析，或者追踪在线bug的时候在某些特定版本也可以将必要的日志打包上传到服务器

2. 可以可用日志工具(如`CocoaLumberjack`)存储到本地文件，可以将崩溃信息一并保存，并提供对应界面让用户主动提交到服务器。

3. 在特殊情况下可能需要用户的全部日志，可以在经用户同意情况下直接上传手机上面的日志文件，里面系统有记录详细的报错信息以及手机当时所处环境。